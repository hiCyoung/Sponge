{
  "title": "Mysql编码配置",
  "cells": [
    {
      "type": "text",
      "data": "1，查看mysql的编码<div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\"><div style=\"font-size: 15px;\">show variables like \"%character%\" ;</div></div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\"><div style=\"font-size: 15px;\">+--------------------------+----------------------------+</div><div style=\"font-size: 15px;\">| Variable_name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| Value &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|</div><div style=\"font-size: 15px;\">+--------------------------+----------------------------+</div><div style=\"font-size: 15px;\">| character_set_client &nbsp; &nbsp; | utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_set_connection | utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_set_database &nbsp; | utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_set_filesystem | binary &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_set_results &nbsp; &nbsp;| utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_set_server &nbsp; &nbsp; | utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_set_system &nbsp; &nbsp; | utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</div><div style=\"font-size: 15px;\">| character_sets_dir &nbsp; &nbsp; &nbsp; | /usr/share/mysql/charsets/ |</div><div style=\"font-size: 15px;\">+--------------------------+----------------------------+</div></div><br><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">2，修改 /etc/mysql/my.cnf</div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">【client】</div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">default-character-set=utf8<br></div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">【mysqld】</div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">character_set_server=utf8<br></div><br><div style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">3，查看mysql日志（不是binlog）</div><p style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">/var/log/mysql$&nbsp;</p><p style=\"font-family: 'Helvetica Neue'; font-size: 15px;\"><br></p><p style=\"font-family: 'Helvetica Neue'; font-size: 15px;\">附录：</p><div style=\"font-family: Times; font-size: 17px; line-height: normal;\"><div style=\"font-family: 'Helvetica Neue'; font-size: 15px; color: rgb(0, 0, 0); font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; line-height: normal; background-color: rgb(245, 245, 245);\">my.cnf should located in /etc</div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px; color: rgb(0, 0, 0); font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; line-height: normal; background-color: rgb(245, 245, 245);\"><span style=\"color: rgb(0, 34, 0); font-family: georgia; font-size: 15px; line-height: 22.5px;\">一、登录</span><a shape=\"rect\" title=\"MySQL\" href=\"http://www.ha97.com/tag/mysql\" target=\"_blank\" style=\"padding: 0px; margin: 0px; color: rgb(0, 102, 0); text-decoration: none; border-bottom-width: 1px; border-bottom-style: dashed; border-bottom-color: rgb(0, 102, 0); font-family: georgia; font-size: 15px; line-height: 22.5px;\">MySQL</a><span style=\"color: rgb(0, 34, 0); font-family: georgia; font-size: 15px; line-height: 22.5px;\">查看用</span><a shape=\"rect\" title=\"SHOW\" href=\"http://www.ha97.com/tag/show\" target=\"_blank\" style=\"padding: 0px; margin: 0px; color: rgb(0, 102, 0); text-decoration: none; border-bottom-width: 1px; border-bottom-style: dashed; border-bottom-color: rgb(0, 102, 0); font-family: georgia; font-size: 15px; line-height: 22.5px;\">SHOW</a><span style=\"color: rgb(0, 34, 0); font-family: georgia; font-size: 15px; line-height: 22.5px;\">&nbsp;VARIABLES LIKE ‘character%’;</span><br clear=\"none\"></div><div style=\"font-family: 'Helvetica Neue'; font-size: 15px; color: rgb(0, 0, 0); font-variant-ligatures: normal; font-variant-east-asian: normal; font-variant-position: normal; line-height: normal; background-color: rgb(245, 245, 245);\"><p style=\"font-family: georgia; font-size: 15px; padding: 0px; margin-top: 1.2em; margin-bottom: 1.2em; line-height: 1.5em; color: rgb(0, 34, 0);\">1、在[client]字段里加入default-character-set=utf8，如下：<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"><code style=\"padding-top: 0px; padding-bottom: 0px; font-size: 12px; background-color: rgb(238, 238, 238);\"><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">[client]<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">port = 3306<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">socket = /var/lib/mysql/mysql.sock<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">default-character-set=utf8<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"></code><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">2、在[mysqld]字段里加入character-set-<a shape=\"rect\" title=\"server\" href=\"http://www.ha97.com/tag/server\" target=\"_blank\" style=\"padding: 0px; margin: 0px; color: rgb(0, 102, 0); text-decoration: none; border-bottom-width: 1px; border-bottom-style: dashed; border-bottom-color: rgb(0, 102, 0);\">server</a>=utf8，如下：<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"><code style=\"padding-top: 0px; padding-bottom: 0px; font-size: 12px; background-color: rgb(238, 238, 238);\"><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">[mysqld]<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">port = 3306<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">socket = /var/lib/mysql/mysql.sock<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">character-set-server=utf8<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"></code><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">3、在[mysql]字段里加入default-character-set=utf8，如下：<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"><code style=\"padding-top: 0px; padding-bottom: 0px; font-size: 12px; background-color: rgb(238, 238, 238);\"><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">[mysql]<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">no-auto-rehash<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">default-character-set=utf8<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"></code><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">修改完成后，service mysql restart重启mysql服务就生效。注意：[mysqld]字段与[mysql]字段是有区别的。这点在网上没人反馈过。</p><p style=\"font-family: georgia; font-size: 15px; padding: 0px; margin-top: 1.2em; margin-bottom: 1.2em; line-height: 1.5em; color: rgb(0, 34, 0);\">使用SHOW VARIABLES LIKE ‘character%’;查看，发现数据库编码全已改成utf8。</p><p style=\"font-size: 15px;\"><br clear=\"none\"></p><p style=\"font-family: georgia; font-size: 15px; padding: 0px; margin-top: 1.2em; margin-bottom: 1.2em; line-height: 1.5em; color: rgb(0, 34, 0);\">4、如果上面的都修改了还乱码，那剩下问题就一定在connection连接层上。解决方法是在发送查询前执行一下下面这句（直接写在SQL文件的最前面）：<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">SET NAMES ‘utf8′;</p><p style=\"font-family: georgia; font-size: 15px; padding: 0px; margin-top: 1.2em; margin-bottom: 1.2em; line-height: 1.5em; color: rgb(0, 34, 0);\">它相当于下面的三句指令：<br clear=\"none\" style=\"padding: 0px; margin: 0px;\"><code style=\"padding-top: 0px; padding-bottom: 0px; font-size: 12px; background-color: rgb(238, 238, 238);\"><br clear=\"none\" style=\"padding: 0px; margin: 0px;\">SET character_set_client = utf8;<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">SET character_set_results = utf8;<br clear=\"none\" style=\"padding: 0px; margin: 0px;\">SET character_set_connection = utf8;</code></p><div><code style=\"padding-top: 0px; padding-bottom: 0px; font-size: 12px; background-color: rgb(238, 238, 238);\"><br></code></div></div></div>"
    }
  ]
}